/// <reference types="cypress" />
import { mount } from "@cypress/vue";
import DeploymentChart from "./DeploymentChart.vue";
import "../../index.css";
import { infoForStatusItem } from "../../types";

beforeEach(() => {
  // add a div for modal to attach to
  cy.document().then((document) => {
    document.body.innerHTML += '<div id="modals"></div>';
  });

  cy.intercept("GET", "**/metrics/**", {
    fixture: "./deployments.json",
  }).as("deployments");

  const projectName = "org";
  const infoForStatusValue: infoForStatusItem = {
    deployments: {
      Daily: {
        info: 'Daily Info Here <ul class="list-disc"><li class="ml-8">First Item</li></ul>',
      },
      Weekly: {
        info: "Weekly Info Here",
      },
      Monthly: {
        info: "Monthly Info Here",
      },
    },
    leadTime: {
      "One Day": {
        info: "Less than One Day",
      },
      "One Week": {
        info: "Less than One Week",
      },
      "One Month": {
        info: "Less than One Month",
      },
      "Greater Than One Month": {
        info: "Greater than One Month",
      },
    },
  };
  //@ts-ignore
  mount(DeploymentChart, {
    propsData: {
      projectName: projectName,
      infoForStatus: infoForStatusValue,
    },
  });
});

it("Chart is Visible", () => {
  cy.wait("@deployments");
  cy.get(".chartWrapper").should("be.visible");
});

// it("Close emit is sent", () => {
//   cy.get("button").contains("Close");
// });

// it("Proper Text is Visible", () => {
//   cy.get("h3").contains("Daily");
// });

// it("Proper Text is Visible", () => {
//   cy.get("p").contains("Daily Info Here");
//   cy.get("p").contains("First Item");
// });
